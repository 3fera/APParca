<!DOCTYPE html>
<html class="ui-mobile">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	<meta name="viewport" content="width=320, initial-scale=1">
	<title>Park and Click</title>

        <meta name="layout" content="mobile">
        
         
          <link href="style.css" rel="stylesheet" type="text/css">
       
	    <link rel="stylesheet" href="jquery.mobile-1.1.0.min.css">
	<script src="jquery-1.7.1.min.js"></script>
	<script src="cordova-1.8.1.js"></script>
	<script src="jquery.mobile-1.1.0.min.js"></script>
	
	<script type="text/javascript" src="https://maps.google.com/maps/api/js?sensor=true"></script>
	
	
	

<script type="text/javascript" charset="utf-8">
	var accuracy=0;
	var lat=0;
	var lng=0;
	var globales=Array();
	// Wait for PhoneGap to load
	//
	document.addEventListener("deviceready", onDeviceReady, false);
	$(document).ready(function() {
		onDeviceReady();	           		   	
   });
   // PhoneGap is ready
   //
   
   function onDeviceReady() {
   		//navigator.geolocation.getCurrentPosition(onSuccess, onError);
   		$(".btn-stop").fadeOut();
	  	$("#info").fadeOut();
	  	
	    $(window).resize(function(){
        	$("#layer-mapa").css("height", $(window).height() - parseInt($(".botones").css("height")) + 5)
        });
	
        $('#selectZonas').on("pagebeforeload", function() {
            $(this).dialog('close');
        });
        jQuery.fx.off = true;
        reloadEvents();
        
       
	  	$(".btn-stop").fadeOut();
	    $(window).resize(function(){
        	$("#layer-mapa").css("height", $(window).height() - parseInt($(".botones").css("height")) + 5)
        });
        $('#selectZonas').on("pagebeforeload", function() {
        	alert($(this))
            $(this).dialog('close');
          });
          
        $.extend(  $.mobile , {
		    defaultPageTransition:"none",
		    defaultDialogTransition:"none"
		  });

	

    }

    // onSuccess Geolocation
    //
    var map;
    
    function checkRun() {
		//comprobamos si hay algun estacionamiento activo con este usuario...
		$.post("http://clients.3fera.com/aparca/json/checkRun/", "1", function(data, textStatus) {
   			//data contains the JSON object
			//textStatus contains	 the status: success, error, etc
			if(data==null) return 0;

			if(data.destino) {
				destino=$(data.destino);
			}else{
	  			destino = null;	
  			}
		  	//Si existe destino
		  	if(destino!=null) {
					destino.fadeOut(500, function () {
            		destino.html(data.html)
            		if(data.html)	
            			destino.fadeIn();
            		if(data.js)
            			eval(data.js);
            		//alert("entra")
        		});
        	}else {
            	if(data.js)
            		eval(data.js);
        	}

   		}, "json");
   	}

   	

    $('#home').live("pagecreate", function() {
		if(navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(function(position){
				initialize(position.coords.latitude,position.coords.longitude, position.coords.accuracy);
			});
		}
		
		checkRun();
		
	
	});
	
	$('#login').live("pagehide", function() {
		if(navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(function(position){
				initialize(position.coords.latitude,position.coords.longitude, position.coords.accuracy);
			});
		}
		//comprobamos si hay algun estacionamiento activo con este usuario...
		
		
		
		checkRun();
	

	});
	
	
	
    function initialize(lat,lng,accuracy) {
		globales['lat']=lat;
    	globales['lng']=lng;
    	globales['accuracy']=accuracy + 150;
		var latlng = new google.maps.LatLng(lat, lng);
		var myOptions = {
			zoom: 16,
			center: latlng,
			disableDefaultUI: true,
			mapTypeId: google.maps.MapTypeId.ROADMAP
		};
	    var map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);
	    
	    var marker = new google.maps.Marker({
			position: latlng, 
			map: map,
		 	title: "Mi coche!"
		});
		marker.setIcon('http://clients.3fera.com/aparca/templates/aparcaMov/images/car.png');
		
	    var circle = new google.maps.Circle({
		    center: latlng,
		    radius: globales['accuracy'],
		    map: map, //your map,
		    fillColor: 'blue', //color,
		    fillOpacity: 0.2, //opacity from 0.0 to 1.0,
		    strokeColor: 'blue', //stroke color,
		    strokeOpacity: 0.5 //opacity from 0.0 to 1.0
		});
		
		//set the zoom level to the circle's size
		map.fitBounds(circle.getBounds());
		
		
		//Zonas
		
		
	}
    
    
	// onError Callback receives a PositionError object
	//
	function onError(error) {
	    alert('code: '    + error.code    + '\n' + 'message: ' + error.message + '\n');
	}
</script>

<script>
    
	var intervalUpdateGasto;
	
	/*para debug*/
	function censor(censor) {
	  return (function() {
	    var i = 0;
	
	    return function(key, value) {
	      if(i !== 0 && typeof(censor) === 'object' && typeof(value) == 'object' && censor == value) 
	        return '[Circular]'; 
	
	      if(i >= 29) // seems to be a harded maximum of 30 serialized objects?
	        return '[Unknown]';
	
	      ++i; // so we know we aren't using the original object anymore
	
	      return value;  
	    }
	  })(censor);
	}
	
	function getDataAttributes(node) {
	    var d = {}, 
	        re_dataAttr = /^data\-(.+)$/;
	
	    $.each(node.get(0).attributes, function(index, attr) {
	        if (re_dataAttr.test(attr.nodeName)) {
	            var key = attr.nodeName.match(re_dataAttr)[1];
	            d[key] = attr.nodeValue;
	        }
	    });
	
	    return d;
	}
	

	
	function reloadEvents() {
		$("[data-json]").unbind('click');
		
			
		
	
			
		$("[data-json]").live("click",function() {
			var padre=$(this).parents('[data-role="dialog"]');
	   		if(padre.length>0) padre.dialog('close'); 
			var element=$(this)
			var destino=$(element.attr("data-json-destino"));
			var dataPost=eval(element.attr("data-json-data"))
			var url='http://clients.3fera.com/aparca/json/'+element.attr("data-json")+'/';
			
			
   			
   			$.mobile.showPageLoadingMsg();
   			
   			console.dir(dataPost);
   			console.dir(url);
   			console.dir(destino);
   			console.dir(element);
   			
   			$.post(url, dataPost, function(data, textStatus) {			
   				//data contains the JSON object
   				//textStatus contains	 the status: success, error, etc
   				console.dir(textStatus);
   				if(data.destino) {
					destino=$(data.destino);
				}else{
		  			destino = null;	
	  			}
			  	//Si existe destino
			  	if(destino!=null) {
  					destino.fadeOut(500, function () {
                		destino.html(data.html)
                		if(data.html)	
                			destino.fadeIn();
                		if(data.js)
                			eval(data.js);
                		//alert("entra")
            		});
            	}else {
                	if(data.js)
                		eval(data.js);
            	}
            	$.mobile.hidePageLoadingMsg();
            	
			}, "json");
			
			
   		});
   }
   var time_segundos = 0;
   
   function formatoT(n){ 
   	totalDigits = 2;
        n = n.toString(); 
        var pd = ''; 
        if (totalDigits > n.length) 
        { 
            for (i=0; i < (totalDigits-n.length); i++) 
            { 
                pd += '0'; 
            } 
        } 
        return pd + n.toString(); 
   } 
   
   function alertDismissed() {
	        alert("nooooo");
	    }

var notificacionEnviada=false;

   function horaLimite(){
		  // alerta cerrada
	    
		  /*if(!notificacionEnviada)
		    navigator.notification.confirm(
			    'Eres el ganador!',     // mensaje (message)
			    alertDismissed,         // función 'callback' (alertCallback)
			    'Game Over',            // titulo (title)
			    'Cerrar'                // nombre del botón (buttonName)
		    );*/
	    
   }
   
   function updateCounter(precioHora, limite){
   		precioMin = (precioHora/60);
   		
   		limite=1;
   		
   		if((time_segundos*60)>=limite){
   			horaLimite();
   			notificacionEnviada=true;
	   		precioT = limite*precioMin;
   		}else{
   			fix = time_segundos + 60;
	   		precioT = precioMin * (Math.floor(fix/60));
   		}
   		
   		var precioTT = precioT.toFixed(2);
   		
   		var horas = Math.floor(time_segundos/3600);
   		var minutos = Math.floor(time_segundos/60);
   		var segundos = Math.floor(time_segundos%60);
   		var tiempo = formatoT(horas) + ":" + formatoT(minutos) + ":" + formatoT(segundos);
   		var html = precioTT + "&euro;<span>" + tiempo + "</span>";
   		$('#tarifaUpdate').html(html);
	  	time_segundos++;
   }
   
      
   function startCounter(precioHora, limite, tiempo){
   		time_segundos = tiempo;
   		updateCounter(precioHora, limite);
   		clearInterval(intervalUpdateGasto);
	    intervalUpdateGasto=setInterval('updateCounter(' + precioHora + "," + limite + ')', 1000);
   }
       
   function getCoordsJSON() {
   		return "lat="+ globales['lat'] +"&lng="+globales['lng']+"&ac="+ globales['accuracy']; 	
   }
   
   function changeTarifa(tipoId){
	   tarifaId = tipoId;
   }
   
   var tarifaId = 0;
   
   function changeMatricula(matriculaId){
	   matriculaId = matriculaId;
   }
   
   var matriculaId = 0;
   
   function getCoordsJSONAndTarifa() {
	   return "lat=" + globales['lat'] + "&lng=" + globales['lng'] + "&ac=" + globales['accuracy'] + "&tipoId=" + globales['tipoId'] + "&matriculaId=" + globales['matriculaId'];
   }
       	
   function getPerfilJSON(){
   		var fields =  
           	"username=" + $("#usernamePerfil").val() 
           	+ "&email=" + $("#emailPerfil").val() 
           	+ "&oldPassword=" + $("#passwordPerfil").val() 
           	+ "&password=" + $("#newPasswordPerfil").val() 
           	+ "&password2=" + $("#newPassword2Perfil").val();
        return fields;
    }
    
   	function getAddVehiculoJSON(){
       	return "matricula=" + $("#matricula").val();
   	}
   	
   	function getRegistroJSON(){
		return "username=" + $("#regUsuario").val() + "&password=" + $("#regPassword").val() + "&email=" + $("#regEmail").val();    	
   	}
   	
   	function getLoginJSON(){
       	return "username=" + $("#username").val() + "&password=" + $("#password").val();
   	}
  	
    function emularClickPopup(element) {
        $("#emulClick").attr("href",element);
        $("#emulClick").click();
    }
    
</script>


	  

</head>

<body>

	<!-- Welcome / Login -->
	<div data-role="page" data-transition="none"  id="login">	
		<div id="logginDiv" data-role="popup" data-overlay-theme="a" data-theme="a" class="ui-corner-all"style="display:none">
			<div style="padding:10px 20px;">
				<h3>Acceso</h3>
				<label for="un" class="ui-hidden-accessible">Usuario:</label>
				<input type="text" name="username" id="username" value="" placeholder="usuario" data-theme="a" />
				
				<label for="pw" class="ui-hidden-accessible">Password:</label>
				<input type="password" name="password" id="password" value="" placeholder="password" data-theme="a" />
				<button type="submit" data-theme="b" data-json="login" data-json-data="getLoginJSON()" class="ui-btn">Login</button>
				
				<a href="#registro" data-role="button" data-theme="b" >Registrate</a>
			</div>
		</div>
		
		<script>
			$('#login').live('pageshow', function () {
				//Check session status
		    	$.post("http://clients.3fera.com/aparca/json/sessionStatus/", "1", function(data, textStatus) {
		   			if(data.js)
		            	eval(data.js);
		   		}, "json");
			});	
	 		 $(function() {
			    $('div[data-role="dialog"]').live('pagebeforeshow', function(e, ui) {
			    	ui.prevPage.addClass("ui-dialog-background ");
			    });
			
			    $('div[data-role="dialog"]').live('pagehide', function(e, ui) {
			    	$(".ui-dialog-background ").removeClass("ui-dialog-background ");
			    });
			});
			
		</script>
	</div>
	
	<!-- Registro -->
	<div data-role="page" data-transition="none"  id="registro" class="ui-corner-all">	
		<div data-role="header" data-theme="a" data-position="inline">
			<a href="#home" data-icon="delete">Volver</a>
			<h1>Herramientas</h1>
		</div>
		<div data-role="content" data-theme="d">
			<h3>Registro</h3>
			
			<div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
				<label for="name-a" class="ui-input-text">Usuario:</label>
				<input type="text" id="regUsuario" value="" placeholder="Usuario" data-theme="a" class="ui-input-text ui-body-a ui-corner-all ui-shadow-inset">
			</div>
			<div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
				<label for="name-a" class="ui-input-text">Password:</label>
				<input type="password" id="regPassword" value="" placeholder="Password" data-theme="a" class="ui-input-text ui-body-a ui-corner-all ui-shadow-inset">
			</div>
			<div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
				<label for="name-a" class="ui-input-text">Email:</label>
				<input type="text" id="regEmail" value="" placeholder="Email" data-theme="a" class="ui-input-text ui-body-a ui-corner-all ui-shadow-inset">
			</div>
			
			<button type="submit" data-theme="b" data-json="registrar" data-json-data="getRegistroJSON()" class="ui-btn">Registrar</button>
		</div>	   
	</div>
	<script>
		$('#registro').live('pageshow', function () {
			$.post("http://clients.3fera.com/aparca/json/getVehiculos/", "1", function(data, textStatus) {
       			if(data.js)
	            	eval(data.js);
       		}, "json");
		});	
	</script>

	<!-- Home -->
	<div data-role="page" data-transition="none"  id="home" style="height: 100%;" class="details-page" data-prefetch>
		<div data-role="content" class="sin-padding" style="height: 90%;" id="layer-mapa" data-theme="a">
            
            <div id="map_content">
            	
                <div id="map_canvas" style="height: 100%;">Cargando mapa</div>
            </div>
        </div>
        <div class="info" id="info"></div>
		<div class="botones" data-theme="a">
			<a href="" data-json="clickEuros" data-json-destino="#info" class="btn-euros"></a>
			<a href="" data-json="clickSearchZonas" data-json-data="getCoordsJSON()" data-json-destino="#info" class="btn-run"></a>
			<a href="#confirmarStop" class="btn-stop" data-rel="dialog"></a>
			<a href="#clickTools" class="btn-tools" data-rel="page" data-shadow="true"  data-transition="pop" data-corners="true"></a>
		</div> 
		<script>
			var deviceReady = 0;
			$('#home').live('pageshow', function () {
				//Check session status
				$.post("http://clients.3fera.com/aparca/json/checkSession/", "1", function(data, textStatus) {
					if(data.js)
			        	eval(data.js);
				}, "json");
				if(!deviceReady){
					onDeviceReady();
					deviceReady = 1;
				}
			});	
		</script>
	</div>

	<!-- Seleccionar zonas -->
	<div data-role="dialog" data-transition="none" id="selectZonas">
		<div data-role="header" data-theme="a"><h1>Seleccione la zona donde ha estacionado</h1></div>
		<div data-role="content" data-theme="d">
			<div class="content">
			</div>
			<br>
			<table width="100%">
				<tr>
					<td>
						<a href="#" data-role="button" data-theme="a"  data-rel="back">Volver</a>
					</td>
					<td>
						<a href="#" data-role="button" data-theme="b"   data-json="clickRun" data-json-data="getCoordsJSONAndTarifa()">Aceptar</a>
					</td>
				</tr>
			</table>		
			</div>	   
	</div>
	   
	<!-- Sin zonas -->
	<div data-role="dialog" data-transition="none"  id="sinZonas" class="ui-corner-all">
		<div data-role="header" data-theme="a"><h1>Sin zonas</h1></div>
		<div data-role="content" data-theme="d">
			No hemos encontrado ninguna zona cerca de su posición. Por favor, revise su configuración GPS si es incorrecto.
			<div id="zonasBotones">
				<a href="#" data-role="button" data-theme="b" data-rel="back">Aceptar</a>
			</div>
		</div>	   
	</div>
	
	<!-- ConfirmarRun -->
	<div data-role="dialog" data-transition="none"  id="confirmarRun" class="ui-corner-all">
		<div data-role="header" data-theme="a"><h1>Confirmar</h1></div>
		<div data-role="content" data-theme="d">
			<div id="confirmarRun_html"></div>
			<a href="#" data-json="clickRun" data-json-data="getCoordsJSONAndTarifa()" data-role="button" data-theme="e">Aceptar</a>
		</div>	   
	</div>
	
	<!-- ConfirmarStop -->
	<div data-role="dialog" data-transition="none"  id="confirmarStop" class="ui-corner-all">
		<div data-role="header" data-theme="a"><h1>Parar estacionamiento</h1></div>
		<div data-role="content" data-theme="d">
			<div class="content">
			¿Desea finalizar su aparcamiento?
			</div>
			<table width="100%">
				<tr>
					<td>
						<a href="#" data-role="button" data-theme="a" data-rel="back">No</a>
					</td>
					<td>
						<a href="#" data-role="button" data-theme="b" data-json="clickStop" data-json-data="getCoordsJSONAndTarifa()">Si</a>
					</td>
				</tr>
			</table>
		</div>	   
	</div>
	
	<!-- showTicketStop -->
	<div data-role="dialog" data-transition="none"  id="showTiketStop" class="ui-corner-all">
		<div data-role="header" data-theme="a"><h1>Resumen de estacionamiento</h1></div>
		<div data-role="content" data-theme="d">
			<div class="content">
			¿Desea finalizar su aparcamiento?
			</div>
			<table width="100%">
				<tr>
					<td>
						<a href="#" data-role="button" data-theme="a" data-rel="exit">Salir</a>
					</td>
					<td>
						<a href="#" data-role="button" data-theme="b" data-rel="back">Volver</a>
					</td>
				</tr>
			</table>
		</div>	   
	</div>
	
	<!-- Herramientas -->
	<div data-role="page" data-transition="none"  id="clickTools" class="ui-corner-all">	
		<div data-role="header" data-theme="a" data-position="inline">
			<a href="#home" data-icon="delete">Volver</a>
			<h1>Herramientas</h1>
		</div>
		<div data-role="content" data-theme="d">
			<div class="content-primary">	
				<ul data-role="listview">
					<li>
						<a href="#gestionVehiculos" class="ui-link-inherit">
							<h3>Gestión de vehículos</h3>
							<p>Desde este apartado podrás dar de alta y baja tu flota de vehículos.</p>
						</a>
					
					</li>
					<li>
						<a href="#perfil" class="ui-link-inherit">
							<h3>Perfil</h3>
							<p>Apartado desde el que podrás cambiar tus datos de acceso a la app.</p>
						</a>
					</li>
					<li>
						<a href="#gestionPagos" class="ui-link-inherit">
							<h3>Gestión de pagos</h3>
							<p>Desde este aparado podras gestionar las formas de pago.</p>
						</a>
					</li>
					<li>
						<a href="#ayuda" class="ui-link-inherit">
							<h3>Ayuda</h3>
							<p>Toda la ayuda y consejos que puedas necesitar los encontraras en este apartado.</p>
						</a>
					</li>
					<li>
						<a href="#" data-json="salir" class="ui-link-inherit">
							<h3>Salir</h3>
							<p>Cierra la sesión actual</p>
						</a>
					</li>
				</ul>
			</div>
		</div>	   
	</div>	   
	<!-- Ayuda -->
	<div data-role="page" data-transition="none"  id="ayuda" class="ui-corner-all">	
		<div data-role="header" data-theme="<?=$themeA?>" data-position="inline">
			<a href="#clickTools" data-icon="delete">Volver</a>
			<h1>Ayuda</h1>
		</div>
		<div data-role="content" data-theme="<?=$themeD?>">
			<div class="content-primary">
				<div data-role="collapsible-set">
					<div data-role="collapsible" data-theme="c" data-content-theme="d">
						<h3>¿Hay que registrarse para utilizar el servicio?</h3>
						<p>Sí, al descargar la aplicación en tu smartphone el sistema te propone el registro de tus datos personales.</p>
					</div>
					<div data-role="collapsible" data-theme="c" data-content-theme="d">
						<h3>¿Funciona el servicio también para usuarios con smarphones de operadoras extranjeras?</h3>
						<p>Si, con cualquier operador, previo registro de datos.</p>
					</div>
					<div data-role="collapsible" data-theme="c" data-content-theme="d">
						<h3>¿Necesito un distintivo aparte de mi matrícula para indicar al controlador que estoy utilizando el servicio de pago APPARCA? </h3>
						<p>No, salvo que algún ayuntamiento lo requiriera. </p>
					</div>
					<div data-role="collapsible" data-theme="c" data-content-theme="d">
						<h3>¿Como puedo registrar más de un coche?</h3>
						<p>No, salvo que algún ayuntamiento lo requiriera. </p>
					</div>
					<div data-role="collapsible" data-theme="c" data-content-theme="d">
						<h3>¿Como puedo registrar más de un coche?</h3>
						<p>En APPARCA se pueden asociar varias matrículas de coches a un solo usuario.. </p>
					</div>
					<div data-role="collapsible" data-theme="c" data-content-theme="d">
						<h3>Están seguros mis datos de la tarjeta de crédito y de mi cuenta bancaria en el sistema? </h3>
						<p>Si, ÁPPARCA cumple los requisitos de la ley de protección de datos y aplica los métodos más recientes para proteger los datos personales de nuestros clientes. No guardamos los datos de tarjetas de crédito/débito en nuestra base de datos. Los datos de la tarjeta se introduce directamente a la aplicación de La Caixa sin necesidad de grabarlos en nuestro sistema. </p>
					</div>
					<div data-role="collapsible" data-theme="c" data-content-theme="d">
						<h3>¿Que hago si cambio el coche? </h3>
						<p>Cambie la matrícula en menú cambio de datos personales del botón ajustes.</p>
					</div>
					<div data-role="collapsible" data-theme="c" data-content-theme="d">
						<h3>¿Puedo pagar la multa con el sistema APPARCA? </h3>
						<p>No.</p>
					</div>
					<div data-role="collapsible" data-theme="c" data-content-theme="d">
						<h3>¿Recibo notificaciones del sistema APPARCA? </h3>
						<p>Sí:
						<ul>
							<li>10 minutos antes de alcanzar el tiempo máximo autorizado.</li>
							<li>En caso de alguna incidencia con su tarjeta de crédito/débito.</li>
							<li>Al finalizar una operación de estacionamiento se visualiza un ticket digital con los datos del mismo. </li>
						</ul>
						</p>
					</div>
					<div data-role="collapsible" data-theme="c" data-content-theme="d">
						<h3>¿Como se realiza el control?</h3>
						<p>El control se realiza verificando la existencia de una operación de estacionamiento en curso en la BBDD de operaciones del sistema para la matrícula del coche estacionado que se comprueba. </p>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Gestion Vehiculos -->
	<div data-role="page" data-transition="none"  id="gestionVehiculos" class="ui-corner-all">	
		<div data-role="header" data-theme="a" data-position="inline">
			<a href="#clickTools" data-icon="delete">Volver</a>
			<h1>Gestión de vehículos</h1>
		</div>
		<div data-role="content" data-theme="d">
			<div class="content-primary">	
				
				<div>
					Matricula
					<input type="text" name="matricula" id="matricula">
					<button type="submit" data-json="addVehiculo" data-json-data="getAddVehiculoJSON()" class="ui-btn">Añadir</button>
				</div>
				<br>
				<ul data-role="listview" id="listaVehiculos">
				</ul>
			</div>
		</div>
		<script>
			$('#gestionVehiculos').live('pageshow', function () {
				//Loading
				$.mobile.showPageLoadingMsg();
	        	//Get vehicles
	        	$.post("http://clients.3fera.com/aparca/json/getVehiculos/", "1", function(data, textStatus) {
	       			if(data.js)
		            	eval(data.js);
		            $('#listaVehiculos').listview('refresh');
	       		}, "json");
			});	
		</script>
	</div>
	
	<!-- Gestion Pagos -->
	<div data-role="page" data-transition="none"  id="gestionPagos" class="ui-corner-all">	
		<div data-role="header" data-theme="a" data-position="inline">
			<a href="#clickTools" data-icon="delete">Volver</a>
			<h1>Gestión de pagos</h1>
		</div>
		<div data-role="content" data-theme="d">
			<div class="content-primary">	
				<ul data-role="listview" id="listaPagos">
					
				</ul>
			</div>
		</div>
		<script>
			$('#gestionPagos').live('pageshow', function () {
				//Loading
				$.mobile.showPageLoadingMsg();
	        	//Get vehicles
	        	$.post("http://clients.3fera.com/aparca/json/getPagos/", "1", function(data, textStatus) {
	       			if(data.js)
		            	eval(data.js);
		            $('#listaPagos').listview('refresh') 
	       		}, "json");
			});	
		</script>
	</div>
	
	<!-- Editar Perfil -->
	<div data-role="page" data-transition="none"  id="perfil" class="ui-corner-all">	
		<div data-role="header" data-theme="a" data-position="inline">
			<a href="#clickTools" data-icon="delete">Volver</a>
			<h1>Perfil</h1>
		</div>
		<div data-role="content" data-theme="d">
			<div class="content-primary">	
				Usuario
				<input type="text" name="username" id="usernamePerfil">
				Email
				<input type="text" name="email" id="emailPerfil">
				Password actual
				<input type="password" name="password" id="passwordPerfil">
				Nuevo password
				<input type="password" name="newPassword" id="newPasswordPerfil">
				Repite el nuevo password
				<input type="password" name="newPassword2" id="newPassword2Perfil">
				<button type="submit" data-json="guardarPerfil" data-json-data="getPerfilJSON()" class="ui-btn">Guardar</button>
			</div>
		</div>
		<script>
			$('#perfil').live('pageshow', function () {
				//Loading
				$.mobile.showPageLoadingMsg();
	        	//Get vehicles
	        	$.post("http://clients.3fera.com/aparca/json/getPerfil/", "1", function(data, textStatus) {
	       			if(data.js)
		            	eval(data.js);
	       		}, "json");
			});	
		</script>
	</div>
	
	
	<!-- Alerta -->
	<div data-role="page" data-transition="none"  id="errorAlert" class="ui-corner-all">
		<div data-role="header" data-theme="a">
			<h1 id="errorAlert_header">dialogo con colores configurados</h1>
		</div>
		<div data-role="content" data-theme="d">
			<div id="errorAlert_html"></div>
		</div>	   
	</div>
	
	<a data-rel="dialog" id="emulClick" href="#" ></a>		
	<a href="" data-json="updateGasto" id="updateGasto" style="display:none"></a>

</body>

</html>